<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html>
<jsp:include page="../common/header.jsp"></jsp:include>
<head>
<meta charset="UTF-8">
<script src="http://code.jquery.com/jquery-3.7.1.js"></script>
<script>
	/* 아이디 저장 기능 */
	//쿠키 설정
	// name : 쿠키명
	// value : 쿠키값
	// exdays : 쿠키 만료일
	function setCookie(name, value, exdays) {
		const todayDate = new Date();
		todayDate.setDate(todayDate.getDate() + exdays);
		document.cookie = name + "=" + escape(value) + ";path=/;expires="
							+ date.toUTCSString(); + ";"
		
		console.log("쿠키 name 확인 " + name);
		console.log("쿠키 확인 " + document.cookie);
	}

	// 쿠키 조회
	function getCookie(name) {
		const cookie = document.cookie;
		if (document.cookie.length > 0) { // 쿠키가 있다면
			var cookieArray = cookie.split(": ");
			for ( var index in cookieArray) {
				var cookieName = cookieArray[index].split("=");
				if (cookieName[0] == name) {
					return cookieName[1];
				}
			}
		}
		return;
	}

	// 아이디 저장하기
	$("btn").click(function() {
		if ($("#idSave").prop('checked')) {
			setCookie('id', $("#mId").val, 100); //100일동안 저장
		} else {
			// 로그인 + 아이디 저장하기 X
			// 만료시간을 현재 시간보다 과거로 지정 > 쿠키 자동 소멸
			setCookie('id', '', -1);
		}
		// 로그인 처리(폼 전송)
		document.login.submit();
	});

	// 페이지 로드
	// 쿠키가 있으면 아이디 셋팅, 비밀번호에 입력 포커스
	if (getCookie('id') != "") {
		$("#mId").val(getCookie('id'));
		$("#idSave").prop('checked', true);
		$("#mPasswd").focus();
	} else {
		$("#mId").focus();
	}
</script>
<c:if test="${param.message == 'error'}">
	<script>
		alert("아이디 또는 비밀번호를 확인해주세요.");
	</script>
</c:if>
<c:if test="${param.message == 'logout'}">
	<script>
		alert("로그아웃 되었습니다.");
		location.href='/syLibrary/user/main/index.jsp';
	</script>
</c:if>
</head>
<body>
	<div class="container"
		style="float: none; margin: 0 auto; margin-top: 3em">
		<h4>로그인</h4>
		<hr>
		<p>로그인을 하시면 보다 더 많은 정보와 서비스를 이용하실 수 있습니다.</p>
		<!--  로그인 입력창 -->
		<form name="login" method="post"
			action="/syLibrary/login_servlet/login.do">
			<!-- 			<div class="row" style="border: 1px solid #D5D5D5; height: 300px"> -->
			<div style="border: 1px solid #D5D5D5; height: 300px; padding: 1em">
				<!-- <div class="col">
				<p>추가하고 싶은 내용</p>
				</div> -->
				<div>
					<div class="input-group mb-3">
						<input type="text" class="form-control" name="mId" id="mId"
							placeholder="아이디">
					</div>
					<div class="input-group mb-3">
						<input type="password" class="form-control" name="mPasswd"
							id="mPasswd" placeholder="비밀번호">
					</div>
					<div class="form-check">
						<input class="form-check-input" type="checkbox" id="idSave">
						<label class="form-check-label" for="idSave">아이디 저장</label>
					</div>
					<div class="input-group mb-3">
						<input type="submit" value="로그인" class="btn text-white"
							style="width: 200px; background-color: lightpink;">
					</div>
				</div>
			</div>
		</form>

		<!-- 아이디 찾기, 비밀번호 찾기, 회원가입 -->
		<div class="row d-flex align-items-center"
			style="background-color: #EAEAEA; border: 1px solid #D5D5D5; height: 300px">
			<div class="col text-center">
				<div>
					<img src="../resources/images/login/id.png">
				</div>
				<div class="btnLoginBottom">
					<a href="../login/searchId.jsp"
						style="text-decoration-line: none; color: black;">아이디 찾기</a>
				</div>
			</div>
			<div class="col text-center">
				<div>
					<img src="../resources/images/login/forgot.png">
				</div>
				<div class="btnLoginBottom">
					<a href="../login/searchPasswd.jsp"
						style="text-decoration-line: none; color: black;">비밀번호 찾기</a>
				</div>
			</div>
			<div class="col text-center">
				<div>
					<img src="../resources/images/login/join.png">
				</div>
				<div class="btnLoginBottom">
					<a href="../member/join.jsp"
						style="text-decoration-line: none; color: black;">회원가입</a>
				</div>
			</div>
		</div>
	</div>
</body>
<jsp:include page="../common/footer.jsp"></jsp:include>
</html>